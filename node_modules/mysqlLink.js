var mysql = require('mysql');

var server = "127.0.0.1";
var user = "pi";
var password = "pihouse";
var database = "pihouse";

const add_hosts_table = "CREATE TABLE hosts ( "
	+"host_id 	INTEGER PRIMARY KEY AUTO_INCREMENT, "
	+"hostname 	VARCHAR(30), "
	+"ipaddr	VARCHAR(30) UNIQUE, "
	+"created	TIMESTAMP DEFAULT CURRENT_TIMESTAMP "
	+")";

const drop_hosts_table = "DROP TABLE hosts";

const read_hosts = "SELECT * FROM hosts";

genericMySQLReturn = function(err,rows,fields)
{
	console.log(JSON.stringify(err));
	console.log(JSON.stringify(rows));
	console.log(JSON.stringify(fields));
}

addTables = function()
{
	var connection = mysql.createConnection({host: server, user: user, password: password, database:database});

	connection.query(drop_hosts_table, genericMySQLReturn);
	connection.query(add_hosts_table, genericMySQLReturn);

	connection.end();
}

getHosts = function(callback)
{
	var connection = mysql.createConnection({host: server, user: user, password: password, database:database});

	connection.query(read_hosts, callback);

	connection.end();
}

module.exports.addTables = addTables;
module.exports.getHosts = getHosts;
